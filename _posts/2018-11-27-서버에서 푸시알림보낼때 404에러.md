---
layout: post
title: 서버에서 푸시알림을 보낼때 404에러가 나는경우
date: 2018-11-27
excerpt: 고쳤다ㅏㅏㅏㅏㅏ
image: ""
sitemap :
  changefreq : daily
  priority : 1.0
---
<div>
  <p>서버에서 푸시알림을 보낼때 다음과 같은 에러가 떳다.</p>
  <pre>
  <code>
    java.util.concurrent.ExecutionException: com.google.firebase.messaging.FirebaseMessagingException: Requested entity was not found.
    at com.google.firebase.tasks.Tasks.getResultOrThrowExecutionException(Tasks.java:179)
    at com.google.firebase.tasks.Tasks.await(Tasks.java:109)
    at com.google.firebase.internal.TaskToApiFuture.get(TaskToApiFuture.java:74)
    at srmoa.bhmoa.push_alarm_fcm.service.PushAlarmFcmServer.sendMsg(PushAlarmFcmServer.java:77)
    at srmoa.bhmoa.push_alarm.service.PushAlarmService$1.run(PushAlarmService.java:102)
    at java.lang.Thread.run(Unknown Source)
  Caused by: com.google.firebase.messaging.FirebaseMessagingException: Requested entity was not found.
    at com.google.firebase.messaging.FirebaseMessaging.handleSendHttpError(FirebaseMessaging.java:266)
    at com.google.firebase.messaging.FirebaseMessaging.makeSendRequest(FirebaseMessaging.java:238)
    at com.google.firebase.messaging.FirebaseMessaging.access$000(FirebaseMessaging.java:58)
    at com.google.firebase.messaging.FirebaseMessaging$1.call(FirebaseMessaging.java:163)
    at com.google.firebase.messaging.FirebaseMessaging$1.call(FirebaseMessaging.java:160)
    at com.google.firebase.tasks.Tasks$1.run(Tasks.java:82)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    ... 1 more
  Caused by: com.google.api.client.http.HttpResponseException: 404 Not Found
  {
    "error": {
      "code": 404,
      "message": "Requested entity was not found.",
      "errors": [
        {
          "message": "Requested entity was not found.",
          "domain": "global",
          "reason": "notFound"
        }
      ],
      "status": "NOT_FOUND"
    }
  }

    at com.google.api.client.http.HttpRequest.execute(HttpRequest.java:1070)
    at com.google.firebase.messaging.FirebaseMessaging.makeSendRequest(FirebaseMessaging.java:233)
    ... 7 more
  </code>
  </pre>
  <p>
  이부분은 Message.builder().setToken할때 들어간 휴대폰의 key? token값이 이전 token(fcmkey)이기때문에 리턴해주는 오류
  </p>
  <pre>
    <code>
       java.util.concurrent.ExecutionException: com.google.firebase.messaging.FirebaseMessagingException: Request contains an invalid          argument.
          at com.google.firebase.tasks.Tasks.getResultOrThrowExecutionException(Tasks.java:179)
          at com.google.firebase.tasks.Tasks.await(Tasks.java:109)
          at com.google.firebase.internal.TaskToApiFuture.get(TaskToApiFuture.java:74)
          at srmoa.bhmoa.push_alarm_fcm.service.PushAlarmFcmServer.sendMsg(PushAlarmFcmServer.java:64)
          at srmoa.bhmoa.push_alarm.service.PushAlarmService$1.run(PushAlarmService.java:59)
          at java.lang.Thread.run(Unknown Source)
Caused by: com.google.firebase.messaging.FirebaseMessagingException: Request contains an invalid argument.
          at com.google.firebase.messaging.FirebaseMessaging.handleSendHttpError(FirebaseMessaging.java:266)
          at com.google.firebase.messaging.FirebaseMessaging.makeSendRequest(FirebaseMessaging.java:238)
          at com.google.firebase.messaging.FirebaseMessaging.access$000(FirebaseMessaging.java:58)
          at com.google.firebase.messaging.FirebaseMessaging$1.call(FirebaseMessaging.java:163)
          at com.google.firebase.messaging.FirebaseMessaging$1.call(FirebaseMessaging.java:160)
          at com.google.firebase.tasks.Tasks$1.run(Tasks.java:82)
          at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
          at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
          ... 1 more
Caused by: com.google.api.client.http.HttpResponseException: 400 Bad Request
{
  "error": {
    "code": 400,
    "message": "Request contains an invalid argument.",
    "errors": [
      {
        "message": "Request contains an invalid argument.",
        "domain": "global",
        "reason": "badRequest"
      }
    ],
    "status": "INVALID_ARGUMENT"
  }
}
          at com.google.api.client.http.HttpRequest.execute(HttpRequest.java:1070)
          at com.google.firebase.messaging.FirebaseMessaging.makeSendRequest(FirebaseMessaging.java:233)
    </code>
  </pre>
  <p>
  잘못된 인수(token? fcmkey?가 이상한값일때 ex) "aaa") 가 요청됐을때 리턴하는 오류
  </p>
  <pre>
  <code>
    Message.builder()
    .setToken("key? token? 값")
    .build()
  </code>
  </pre>
</div>
